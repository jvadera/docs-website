---
title: Troubleshoot your Kafka integration
metaDescription: "Troubleshoot your Kafka integration."
redirects: 
---

## Duplicate data reporting [#duplicate-data]

For agents monitoring producers and/or consumers, and that have `Topic mode` set to `All`:, there may be a problem of duplicate data being reported. To stop the duplicate data: ensure that the [configuration option](#config) `Collect topic size` is set to false.

## Integration logs errors `zk: node not found` [#logs-error-node]

Ensure that `zookeeper_path` is set correctly in the [configuration file](#config).

## JMX connection errors [#jmx-connection]

    The Kafka integration uses a JMX helper tool called `nrjmx` to retrieve JMX metrics from brokers, consumers, and producers. JMX needs to be enabled and configured on all brokers in the cluster. Also, firewalls need to be tuned to allow connections from the host running the integration to the brokers over the JMX port.

    To check whether JMX is correctly configured, run the following command for each broker from the machine running the Kafka integration. Replace the `PORT`, `USERNAME`, and `PASSWORD` variables with the corresponding JMX settings for the brokers:

    ```shell
    echo "*:*" | nrjmx -hostname MY_HOSTNAME -port MY_PORT -v -username MY_USERNAME -password MY_PASSWORD
    ```

    The command should generate the output showing a long series of metrics without any errors.

## Kerberos authentication failing [#kerberos-fail]

    The integration might show an error like the following:

    ```shell
    KRB Error: (6) KDC_ERR_C_PRINCIPAL_UNKNOWN Client not found in Kerberos database
    ```

    Check the keytab with kinit command. Replace the highlighted fields with your values:

    ```shell
    $ kinit -k -t KEY_TAB_PATH USERNAME
    ```

    If the username/keytab combination is correct, the command above should finish without printing any errors.

    Check the realm using klist command:

    ```shell
    $ klist |grep "Default principal:"
    ```

    You should see something like this:

    ```shell
    Default principal: johndoe@a_realm_name
    ```

    Check that the printed user name and realm match the `sasl_gssapi_realm` and `sasl_gssapi_username` parameters in the integration configuration.
